<!DOCTYPE html>
<html>
<head lang="en">
	<title>core-list</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	<script src="../../webcomponentsjs/webcomponents.js"></script>
	<link rel="import" href="../../polymer/polymer.html">
	<link rel="import" href="../../paper-button/paper-button.html">
	<link rel="import" href="../cbn-save-excel.html">

	<link rel="import" href="../../iron-demo-helpers/demo-snippet.html">
	<link rel="import" href="../../iron-demo-helpers/demo-pages-shared-styles.html">
</head>
<body>
<form id="demoForm" is="cbn-form" model>
	<demo-snippet class="centered-demo" style="position:relative">
		<template is="dom-bind">
			<textarea id="values" rows="10" cols="100">
				[
					["test", "test2"],
					["test", "test2"],
					["test", "test2"]
				]
			</textarea>
			<br />
			<paper-button raised on-tap="saveExcel">Save to excel</paper-button>
			<cbn-save-excel id="save_excel_elem"></cbn-save-excel>
		</template>
	</demo-snippet>
	<br/>
</form>
<script>
	window.addEventListener('WebComponentsReady', function() {
		// imports are loaded and elements have been registered
		var app = document.querySelector("template[is=dom-bind]");
		app.saveExcel = function(){
			app.$.save_excel_elem.data = app.$.values.value;
			app.$.save_excel_elem.arrayToXLSX();
		}
	});
</script>
</body>
</html>
